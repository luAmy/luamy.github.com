import{A as $,k as j,a as N,x as U,g as P,f as D,b as q,h as z,j as I,y as A,q as R,r as J}from"./_element-plus-22095640.js";import{_ as B}from"./plus-fbf0de5b.js";import{Z as M}from"./__vendor-d29dd9de.js";import{P as G}from"./Pagination-cb60d865.js";import{_ as Y}from"./plugin-vue_export-helper-46f75680.js";import{g as x,r as L,w as Z,o as g,T as S,U as o,a as H,_ as e,Y as b,c as E,a8 as K,F as O,t as Q}from"./_@vue-8661df55.js";import"./_@element-plus-205714a8.js";/* empty css                                                               */const W=["src"],X={class:"dialog-footer"},ee={__name:"listDialog",props:{viewForm:{type:Object},winShow:{type:Boolean,default:!1},editType:{type:String,default:"add"}},emits:["close","confirm"],setup(T,{emit:t}){const _=T,p=x(!1),a=L({addForm:{categoryCode:"",unityId:"",price:"",priceType:"",propName:"",resource:"",type:""},types:[],priceTypes:[],categorys:[],fileList:[]}),y=x(null);Z(()=>_.winShow,async n=>{var m,u;if(p.value=n,a.addForm=JSON.parse(JSON.stringify(_.viewForm)),a.categorys.length,n&&((m=y.value)==null||m.resetFields()),n&&_.editType==="edit"){const{picUrl:r}=a.addForm,d=r==null?void 0:r.split("/")[2];d&&(a.fileList=[{name:d,url:baseUrl+r}])}else a.fileList=[];const l=a.categorys.filter(r=>r.label===a.addForm.categoryName);a.addForm.type="",a.addForm.categoryCode=(u=l[0])==null?void 0:u.value});function w(){y.value.validate(n=>{n&&(delete a.addForm.categoryName,_.editType==="add"?insertProp(a.addForm).then(l=>{N.success("\u65B0\u589E\u6210\u529F"),i()}):updateProp(a.addForm).then(l=>{N.success("\u7F16\u8F91\u6210\u529F"),i()}))})}const F=(n,l)=>{a.imageUrl=URL.createObjectURL(l.raw)};function h(){p.value=!1,t("close")}function i(){p.value=!1,t("confirm")}return(n,l)=>{const m=A,u=U,r=P,d=D,v=B,V=q,c=$,k=z,f=I,C=j;return g(),S(C,{modelValue:p.value,"onUpdate:modelValue":l[4]||(l[4]=s=>p.value=s),"before-close":h},{footer:o(()=>[H("span",X,[e(f,{type:"primary",onClick:w},{default:o(()=>[b("\u786E\u8BA4")]),_:1})])]),default:o(()=>[e(k,{class:"place-info",size:"large","label-width":"120px","label-align":"right",model:a.addForm,ref_key:"form",ref:y},{default:o(()=>[e(r,{label:"\u5546\u54C1\u7C7B\u578B:",prop:"type",rules:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"change"}]},{default:o(()=>[e(u,{modelValue:a.addForm.type,"onUpdate:modelValue":l[0]||(l[0]=s=>a.addForm.type=s),placeholder:"\u8BF7\u9009\u62E9"},{default:o(()=>[(g(!0),E(O,null,K(a.types,s=>(g(),S(m,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"\u5546\u54C1\u540D\u79F0:",prop:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"blur"}]},{default:o(()=>[e(d,{modelValue:a.addForm.name,"onUpdate:modelValue":l[1]||(l[1]=s=>a.addForm.name=s)},null,8,["modelValue"])]),_:1}),e(r,{label:"\u56FE\u7247:",prop:"resource",rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20",trigger:"blur"}]},{default:o(()=>[e(c,{"on-success":F,class:"avatar-uploader",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15","show-file-list":!1},{default:o(()=>[a.imageUrl?(g(),E("img",{key:0,src:a.imageUrl,class:"avatar"},null,8,W)):(g(),S(V,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[e(v)]),_:1}))]),_:1})]),_:1}),e(r,{label:"\u5E93\u5B58:",prop:"price",rules:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"blur"},{pattern:/^[1-9]+[0-9]*$/,message:"\u8BF7\u8F93\u5165\u6B63\u6574\u6570",trigger:"blur"}]},{default:o(()=>[e(d,{modelValue:a.addForm.price,"onUpdate:modelValue":l[2]||(l[2]=s=>a.addForm.price=s),maxlength:"7"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u4EF7\u683C:",prop:"price",rules:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"blur"},{pattern:/^[1-9]+[0-9]*$/,message:"\u8BF7\u8F93\u5165\u6B63\u6574\u6570",trigger:"blur"}]},{default:o(()=>[e(d,{modelValue:a.addForm.price,"onUpdate:modelValue":l[3]||(l[3]=s=>a.addForm.price=s),maxlength:"7"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};var ae=Y(ee,[["__scopeId","data-v-313ca0db"]]);const pe={__name:"list",setup(T){M();const t=L({tableData:[{name:"\u5564\u9152"}],viewForm:{},searchForm:{unityId:"",propName:"",type:"",categoryPart:""},total:0,page:{pageSize:10,pageNum:1},winShow:!1,winShow2:!1});Q(()=>{});function _(i){t.page=i,p()}function p(){const{pageSize:i,pageNum:n}=t.page,{unityId:l,propName:m,type:u,categoryPart:r}=t.searchForm;queryProp({pageSize:i,pageNum:n,unityId:l,propName:m,type:u,categoryPart:r}).then(d=>{t.tableData=d.data.list,t.total=d.data.total})}function a(){t.viewForm={},t.editType="add",t.winShow=!0}function y(){p(),w()}function w(){t.winShow=!1}function F(i,n){t.viewForm=n,t.editType=i,t.winShow=!0}function h(i){const{propCode:n}=i;deleteProp({propCode:n}).then(l=>{N.success("\u5220\u9664\u6210\u529F"),p()})}return(i,n)=>{const l=D,m=P,u=U,r=I,d=B,v=q,V=z,c=R,k=J;return g(),E(O,null,[e(V,{class:"searchForm",size:"large",inline:!0,model:t.searchForm},{default:o(()=>[e(m,{label:"\u5546\u54C1\u540D\u79F0:"},{default:o(()=>[e(l,{modelValue:t.searchForm.propName,"onUpdate:modelValue":n[0]||(n[0]=f=>t.searchForm.propName=f),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1}),e(m,{label:"\u5546\u54C1\u7C7B\u578B:"},{default:o(()=>[e(u)]),_:1}),e(m,null,{default:o(()=>[e(r,{type:"primary",size:"default",onClick:p},{default:o(()=>[b("\u67E5\u8BE2")]),_:1}),e(r,{type:"primary",size:"default",onClick:a},{default:o(()=>[e(v,null,{default:o(()=>[e(d)]),_:1}),b(" \u6DFB\u52A0")]),_:1})]),_:1})]),_:1},8,["model"]),e(k,{size:"large",data:t.tableData,style:{width:"100%","margin-bottom":"20px"}},{default:o(()=>[e(c,{type:"index",label:"\u5E8F\u53F7",width:"80",align:"center"}),e(c,{prop:"name",label:"\u5546\u54C1\u540D\u79F0",align:"center"}),e(c,{prop:"category",label:"\u5546\u54C1\u7C7B\u578B",align:"center"}),e(c,{prop:"price",label:"\u4EF7\u683C",align:"center"}),e(c,{width:"200",label:"\u64CD\u4F5C",align:"center"},{default:o(f=>[e(r,{link:"",type:"primary",onClick:C=>F("edit",f.row)},{default:o(()=>[b("\u7F16\u8F91")]),_:2},1032,["onClick"]),e(r,{link:"",type:"danger",onClick:C=>h(f.row)},{default:o(()=>[b("\u5220\u9664")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(G,{onGetPage:_,total:t.total},null,8,["total"]),e(ae,{editType:t.editType,viewForm:t.viewForm,winShow:t.winShow,onConfirm:y,onClose:w},null,8,["editType","viewForm","winShow"])],64)}}};export{pe as default};
