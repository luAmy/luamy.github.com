import{A,k as R,a as T,x as $,g as q,f as D,b as z,h as I,j as B,y as J,q as M,r as G}from"./_element-plus-22095640.js";import{_ as L}from"./plus-fbf0de5b.js";import{Z as Y}from"./__vendor-d29dd9de.js";import{P as Z}from"./Pagination-cb60d865.js";import{s as h}from"./request-67f9b1d0.js";import{g as H}from"./formatter-87423264.js";import{_ as K}from"./plugin-vue_export-helper-46f75680.js";import{g as U,r as O,w as Q,o as y,T as E,U as a,a as W,_ as e,Y as w,c as x,a8 as X,F as j,t as ee}from"./_@vue-8661df55.js";import"./_@element-plus-205714a8.js";/* empty css                                                               */import"./index-1afde4e9.js";const v="/backProp",te=p=>h.get(`${v}/queryProp${H(p)}`,{}),oe=p=>h.post(`${v}/insertProp`,p),ae=p=>h.post(`${v}/updateProp`,p),le=p=>h.post(`${v}/deleteProp`,p);const re=["src"],ne={class:"dialog-footer"},se={__name:"listDialog",props:{viewForm:{type:Object},winShow:{type:Boolean,default:!1},editType:{type:String,default:"add"}},emits:["close","confirm"],setup(p,{emit:o}){const f=p,m=U(!1),t=O({addForm:{categoryCode:"",unityId:"",price:"",priceType:"",propName:"",resource:"",type:""},types:[],priceTypes:[],categorys:[],fileList:[]}),b=U(null);Q(()=>f.winShow,async n=>{var u,c;if(m.value=n,t.addForm=JSON.parse(JSON.stringify(f.viewForm)),t.categorys.length,n&&((u=b.value)==null||u.resetFields()),n&&f.editType==="edit"){const{picUrl:r}=t.addForm,d=r==null?void 0:r.split("/")[2];d&&(t.fileList=[{name:d,url:baseUrl+r}])}else t.fileList=[];const l=t.categorys.filter(r=>r.label===t.addForm.categoryName);t.addForm.type="",t.addForm.categoryCode=(c=l[0])==null?void 0:c.value});function F(){b.value.validate(n=>{n&&(delete t.addForm.categoryName,f.editType==="add"?oe(t.addForm).then(l=>{T.success("\u65B0\u589E\u6210\u529F"),i()}):ae(t.addForm).then(l=>{T.success("\u7F16\u8F91\u6210\u529F"),i()}))})}const V=(n,l)=>{t.imageUrl=URL.createObjectURL(l.raw)};function k(){m.value=!1,o("close")}function i(){m.value=!1,o("confirm")}return(n,l)=>{const u=J,c=$,r=q,d=D,C=L,P=z,_=A,S=I,g=B,N=R;return y(),E(N,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=s=>m.value=s),"before-close":k},{footer:a(()=>[W("span",ne,[e(g,{type:"primary",onClick:F},{default:a(()=>[w("\u786E\u8BA4")]),_:1})])]),default:a(()=>[e(S,{class:"place-info",size:"large","label-width":"120px","label-align":"right",model:t.addForm,ref_key:"form",ref:b},{default:a(()=>[e(r,{label:"\u5546\u54C1\u7C7B\u578B:",prop:"type",rules:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"change"}]},{default:a(()=>[e(c,{modelValue:t.addForm.type,"onUpdate:modelValue":l[0]||(l[0]=s=>t.addForm.type=s),placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(y(!0),x(j,null,X(t.types,s=>(y(),E(u,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"\u5546\u54C1\u540D\u79F0:",prop:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"blur"}]},{default:a(()=>[e(d,{modelValue:t.addForm.name,"onUpdate:modelValue":l[1]||(l[1]=s=>t.addForm.name=s)},null,8,["modelValue"])]),_:1}),e(r,{label:"\u56FE\u7247:",prop:"resource",rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20",trigger:"blur"}]},{default:a(()=>[e(_,{"on-success":V,class:"avatar-uploader",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15","show-file-list":!1},{default:a(()=>[t.imageUrl?(y(),x("img",{key:0,src:t.imageUrl,class:"avatar"},null,8,re)):(y(),E(P,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[e(C)]),_:1}))]),_:1})]),_:1}),e(r,{label:"\u5E93\u5B58:",prop:"price",rules:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"blur"},{pattern:/^[1-9]+[0-9]*$/,message:"\u8BF7\u8F93\u5165\u6B63\u6574\u6570",trigger:"blur"}]},{default:a(()=>[e(d,{modelValue:t.addForm.price,"onUpdate:modelValue":l[2]||(l[2]=s=>t.addForm.price=s),maxlength:"7"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u4EF7\u683C:",prop:"price",rules:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"blur"},{pattern:/^[1-9]+[0-9]*$/,message:"\u8BF7\u8F93\u5165\u6B63\u6574\u6570",trigger:"blur"}]},{default:a(()=>[e(d,{modelValue:t.addForm.price,"onUpdate:modelValue":l[3]||(l[3]=s=>t.addForm.price=s),maxlength:"7"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};var ie=K(se,[["__scopeId","data-v-e9f469be"]]);const Fe={__name:"list",setup(p){Y();const o=O({tableData:[{name:"\u5564\u9152"}],viewForm:{},searchForm:{unityId:"",propName:"",type:"",categoryPart:""},total:0,page:{pageSize:10,pageNum:1},winShow:!1,winShow2:!1});ee(()=>{});function f(i){o.page=i,m()}function m(){const{pageSize:i,pageNum:n}=o.page,{unityId:l,propName:u,type:c,categoryPart:r}=o.searchForm;te({pageSize:i,pageNum:n,unityId:l,propName:u,type:c,categoryPart:r}).then(d=>{o.tableData=d.data.list,o.total=d.data.total})}function t(){o.viewForm={},o.editType="add",o.winShow=!0}function b(){m(),F()}function F(){o.winShow=!1}function V(i,n){o.viewForm=n,o.editType=i,o.winShow=!0}function k(i){const{propCode:n}=i;le({propCode:n}).then(l=>{T.success("\u5220\u9664\u6210\u529F"),m()})}return(i,n)=>{const l=D,u=q,c=$,r=B,d=L,C=z,P=I,_=M,S=G;return y(),x(j,null,[e(P,{class:"searchForm",size:"large",inline:!0,model:o.searchForm},{default:a(()=>[e(u,{label:"\u5546\u54C1\u540D\u79F0:"},{default:a(()=>[e(l,{modelValue:o.searchForm.propName,"onUpdate:modelValue":n[0]||(n[0]=g=>o.searchForm.propName=g),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1}),e(u,{label:"\u5546\u54C1\u7C7B\u578B:"},{default:a(()=>[e(c)]),_:1}),e(u,null,{default:a(()=>[e(r,{type:"primary",size:"default",onClick:m},{default:a(()=>[w("\u67E5\u8BE2")]),_:1}),e(r,{type:"primary",size:"default",onClick:t},{default:a(()=>[e(C,null,{default:a(()=>[e(d)]),_:1}),w(" \u6DFB\u52A0")]),_:1})]),_:1})]),_:1},8,["model"]),e(S,{size:"large",data:o.tableData,style:{width:"100%","margin-bottom":"20px"}},{default:a(()=>[e(_,{type:"index",label:"\u5E8F\u53F7",width:"80",align:"center"}),e(_,{prop:"name",label:"\u5546\u54C1\u540D\u79F0",align:"center"}),e(_,{prop:"category",label:"\u5546\u54C1\u7C7B\u578B",align:"center"}),e(_,{prop:"price",label:"\u4EF7\u683C",align:"center"}),e(_,{width:"200",label:"\u64CD\u4F5C",align:"center"},{default:a(g=>[e(r,{link:"",type:"primary",onClick:N=>V("edit",g.row)},{default:a(()=>[w("\u7F16\u8F91")]),_:2},1032,["onClick"]),e(r,{link:"",type:"danger",onClick:N=>k(g.row)},{default:a(()=>[w("\u5220\u9664")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(Z,{onGetPage:f,total:o.total},null,8,["total"]),e(ie,{editType:o.editType,viewForm:o.viewForm,winShow:o.winShow,onConfirm:b,onClose:F},null,8,["editType","viewForm","winShow"])],64)}}};export{Fe as default};
